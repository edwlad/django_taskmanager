# Курсовой по Джанго: TaskManagers

## Введение

Задание: реализовать приложение **TaskManager** для работы с тасками (задачами). Минимальные фичи:

- управление задачами (создание\изменение (в том числе переход по статусам и назначение исполнителя) \удаление)
- управление статусами задачи (создание\изменение (в том числе последовательности статусов) \удаление)
- разделение задач по проектам (+ создание\изменение\удаление проектов)
- разделение задач по спринтам внутри проектов (+создание\изменение\удаление спринтов)
- просмотр истории изменения задач
- оповещение исполнителя об изменении текущего статуса задачи

## Требования

- должна быть авторизация
- должно быть не менее одной модели. Между моделями (не обязательно
всеми) должна существовать связь.
- должны быть юнит-тесты
- должно быть rest api, использоваться сериализаторы drf.
- должно быть логгирование
- должно быть графическое представление для пользователей, которого хватает для управления функционалом приложения

## Реализация

### Используемые ресурсы

- Интерпретатор [Python v 3.10](https://www.python.org/).
- Фреймворк [Django 4.1](https://www.djangoproject.com/).
- База данных [Postgres](https://).
- Модуль [Django REST framework](https://www.django-rest-framework.org/).
- и другие модули [requirements.txt](requirements.txt)

### Особенности, работа

#### Доработка manage.py

Добавлено распознавание аргументов запуска и вывода информации для модуля **Coverage**. Аргументы:

- `--cov` - запускать модуль Coverage
- `--skip-covered` - не выводить в отчете информацию о модулях со 100% покрытием
- `--skip-empty` - не выводить в отчете информацию о пустых модулях
- `--show-missing` - выводить в отчете информацию о пропущеных строках в модулях

Пример команды для запуска тестов:  
`python manage.py --cov --skip-covered --skip-empty test`

#### Тестирование

В тестировании (на момент создания README) два блока.

В первом блоке генерируются случайные данные (если база пустая) и проверяется корректность записанной информации в базе.

Во втором блоке генерируются случайные данные (если база пустая) и иммитируеся открытие страниц со списками проектов, спринтов и задач. Проверяется наличие шаблона и коррекность выбранных данных.

Использование кода в тестировании (на момент создания README):

```text
Name  Stmts   Miss  Cover  
TOTAL 1306    356    73%
```

#### Генерация данных

Проект позволяет сгенерировать данные. Можно запустить файл [generator.bat](generator.bat) или, например, воспользоваться командой:  
`python manage.py shell -c="from app_task.functions import gen_data; gen_data(cnt=50, close=60, clear=True, parent=True, clear_user=True)"`  
Запустится функция `gen_data` из модуля `app_task.functions`. Ниже описание параметров функции (указаны значения по умолчанию):

- `cnt=0` - Количество генерируемых проектов,
- `close=0` - Процент закрытия проектов и спринтов
- `clear=False` - Очищать базу перед генерацией
- `parent=False` - Создавать зависимые задачи
- `clear_user=False` - Удалить тестовых пользователей

Даты для данных выбираются из диапазона +\\- 3 месяца от текущей даты. Шаблон начала имени тестового пользователя указан в настройках `MY_TEST_USER`. Если его нет, то - `user`. Пароль - `MY_TEST_PASS` или, если нет, то - `U-321rew`. Шаги генерации данных:

1. Если есть очистка базы, то удаляются все проекты (а соответственно все зависимые спринты и задачи) авторами которых являются тестовые пользователи.
1. Если есть удаление тестовых пользователей, то удаляются пользователи совпадающие с шаблоном.
1. Если количество генерируемых проектов не равно нулю и не найдены тестовые пользователи, то генерируются пять пользователей по шаблону:  
`<значение_MY_TEST_USER><счётчик_начиная_с_0>`  
Пароль - из настрйки `MY_TEST_PASS`
1. Создётся указанное число проектов. Для проекта указывается случайные автор, дата создания и планируемая дата закрытия.  
1. Создётся удвоеное число спринтов. Для спринтов - случайные автор, проект, дата создания и планируемая дата закрытия.  
1. Создётся в десять раз увеличеное число задач. Для задач - случайные автор, исполнитель, проект, спринт, дата создания и планируемая дата закрытия.
1. Если есть зависимые задачи, попытка в поекте создать их. Выбираются две случайные задачи проекта главная и зависимая.
1. Попытка закрыть указанное число спринтов. Выбираются случайные даты закрытия задач (не всех) спринта и дата закрытия спринта.  
1. Попытка закрыть указанное число проектов. Выбирается случайные даты закрытия задач (не всех) проекта и дата закрытия проекта.

Запись данных происходит с помощью метода `save` модели. В результате при записи проверяется корректность информации:

- даты больше/меньше чем надо,
- можно ли создать зависимости
- можно ли закрыть проект/спринт/задачу
- и пр.

